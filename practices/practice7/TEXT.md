# Practice 7: 結合テストの役割

## 学習目標

- 単体テストと結合テストの違いを理解する
- 「どこを単体テスト、どこを結合テストで検証するか」を判断できるようになる
- 複数モジュールを組み合わせたテストが書けるようになる

## 単体テストと結合テスト

| 種類           | テスト対象           | 目的                           |
| -------------- | -------------------- | ------------------------------ |
| **単体テスト** | 関数やクラス1つ      | 個々の部品が正しく動くか確認   |
| **結合テスト** | 複数モジュールの連携 | 部品同士が正しく連携するか確認 |

### たとえ話

- 単体テスト = エンジン単体が動くかチェック
- 結合テスト = エンジンをシャーシに載せて走るかチェック

## テストの分離と結合の判断

### 単体テストが適しているケース

- 純粋関数（入力→出力が決まっている）
- 独立したバリデーションロジック
- ユーティリティ関数

### 結合テストが適しているケース

- データの流れを通して検証したい
- モジュール間のインターフェースが正しいか確認したい
- ユーザーの操作に近い動きをテストしたい

## テスト設計の戦略

```
        結合テスト（少数）
       /              \
      /                \
     /  単体テスト（多数）\
    /____________________\
```

**テストピラミッド**: 単体テストを多く、結合テストは少なく。この比率がテストの保守性を高めます。

### なぜこの比率？

- 単体テストは速い・安定・特定しやすい
- 結合テストは遅い・壊れやすい・原因特定が難しい
- でも結合テストでしか見つからないバグもある

## 演習

`practices/practice7/target.ts` には複数のモジュールが定義されています。

- 個々の関数に対する **単体テスト**
- 関数を組み合わせた **結合テスト**

の両方を書いてみましょう。

`practices/practice7/target.test.ts` を開いて、テストの分離と結合を意識しながらテストを完成させてください。

### ポイント

- まず各関数の単体テストを書く
- 次に関数を組み合わせた結合テストを書く
- 「この不具合は単体テストで見つかるか？結合テストでないと見つからないか？」を考える
