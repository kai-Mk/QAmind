# Practice 9: 単体/結合の責務分担

## 学習目標

- 中規模機能に対して、単体テストと結合テストの責務を自分で判断できるようになる
- テスト設計書を自分で作成できるようになる
- テストピラミッドを意識した設計ができるようになる

## テスト設計のプロセス

1. **要件を分析** - 機能を構成する「部品」に分解する
2. **単体テストの設計** - 各部品を個別にテストするケースを考える
3. **結合テストの設計** - 部品の連携をテストするケースを考える
4. **テストの実装** - 設計に基づいてテストコードを書く
5. **実装** - テストが通るように機能を実装する

## 演習: 注文処理システム

以下の要件に基づいて、テスト設計を行い、テスト→実装してください。

### 要件定義

**注文処理システム**の以下の機能を実装してください。

#### 在庫管理

- 商品ごとの在庫数を管理する
- 注文時に在庫を減らす
- 在庫が足りない場合はエラー

#### 価格計算

- 商品の単価 × 数量で小計を計算
- 税率10%で税込価格を算出（端数切り捨て）

#### 注文処理

- 在庫チェック → 価格計算 → 注文確定の流れ
- 注文確定時に在庫を更新する
- 注文結果として注文ID、明細、合計金額を返す

### 進め方

1. 要件を「部品」に分解する（在庫管理、価格計算、注文処理）
2. 各部品の単体テストを書く
3. 注文処理の結合テストを書く
4. テストが通る実装を書く

### ポイント

- 単体テストで各部品を徹底的に検証する
- 結合テストでは部品の連携に焦点を当てる
- 単体テストで確認済みの細かいケースは結合テストで繰り返さない
