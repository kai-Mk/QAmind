# Practice 3: 同値分割

## 学習目標

- 同値分割（同値クラス分割）の考え方を理解する
- テストケースを「効率的に」選ぶ方法を身につける
- `toContain` や `toMatch` を使えるようになる

## 同値分割とは？

入力値を「同じ振る舞いをするグループ」に分けて、各グループから代表的な値を1つ選んでテストする手法です。

### なぜ同値分割？

すべての値をテストするのは不可能です。でも「同じ動きをする値」は1つテストすれば十分です。

### 例: 成績ランク分類

| 点数の範囲 | ランク | 同値クラス |
| ---------- | ------ | ---------- |
| 90〜100    | A      | クラス1    |
| 70〜89     | B      | クラス2    |
| 50〜69     | C      | クラス3    |
| 0〜49      | D      | クラス4    |

各クラスから代表値を1つ選べば、4つのテストケースで十分です：

```ts
it.each([
  { score: 95, expected: 'A' }, // クラス1の代表値
  { score: 80, expected: 'B' }, // クラス2の代表値
  { score: 60, expected: 'C' }, // クラス3の代表値
  { score: 30, expected: 'D' }, // クラス4の代表値
])('点数 $score → ランク $expected', ({ score, expected }) => {
  expect(getGrade(score)).toBe(expected)
})
```

## 境界値分析との違い

| 手法       | 注目するポイント           | 目的                     |
| ---------- | -------------------------- | ------------------------ |
| 境界値分析 | 切り替わるポイントの前後   | 境界のバグを見つける     |
| 同値分割   | 同じ振る舞いをするグループ | テストケースを効率化する |

実際のテスト設計では、**両方を組み合わせる**のが効果的です。

## vitestの構文: `toContain`

配列に特定の要素が含まれているかチェックします。

```ts
const fruits = ['apple', 'banana', 'cherry']
expect(fruits).toContain('banana') // OK
```

## vitestの構文: `toMatch`

文字列が正規表現や部分文字列にマッチするかチェックします。

```ts
expect('hello world').toMatch('hello') // 部分一致
expect('hello world').toMatch(/^hello/) // 正規表現
```

## 演習

`practices/practice3/target.ts` に定義されている関数に対して、同値分割を意識したテストを書いてみましょう。

`practices/practice3/target.test.ts` を開いて、入力を同値クラスに分けてからテストケースを設計してください。

### ポイント

- まず入力値を「同じ動きをするグループ」に分ける
- 各グループから代表値を1つ選ぶ
- 境界値分析と組み合わせるとより効果的
